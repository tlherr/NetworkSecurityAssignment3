
=====================================
Config for Router: {{ router.name }}
=====================================

{# Enable Security Package #}

+++++++++++++++++++++++++++++++++++++
Part 1: Enable Module
+++++++++++++++++++++++++++++++++++++

!
enable
!
config terminal
!
license boot module c2900 technology-package securityk9
yes
!
end
!
write
!
reload
yes
!

+++++++++++++++++++++++++++++++++++++
Part 2: Config
+++++++++++++++++++++++++++++++++++++

{# PHASE 1 #}
!
enable
!
config terminal
!
crypto isakmp policy 10
!
hash md5
!
authentication pre-share
!
crypto isakmp key {{ router.key }} address {{ router.remote_peer_ip }}
!

{# PHASE 2 #}

!
crypto ipsec transform-set {{router.set_name}} esp-des esp-md5-hmac
!
crypto map {{router.map_name}} 10 ipsec-isakmp
!
set peer {{router.remote_peer_ip}}
!
set transform-set myset
!
match address 100
!

{# PHASE 3: (Apply Crypto Map to outside Interface) #}

!
interface {{router.outside_interface}}
!
crypto map {{router.map_name}}
!
access-list 100 permit ip {{router.local_internal_network}} 0.0.0.255 {{router.remote_internal_network}} 0.0.0.255
!
ip nat inside source list 1 interface {{router.inside_interface}} overload
!
access-list 1 permit {{router.local_internal_network}} 0.0.0.255
!

{# Change NAT #}
!
access-list 122 deny ip {{router.local_internal_network}} 0.0.0.255 {{router.remote_internal_network}} 0.0.0.255
!
access-list 122 permit ip {{router.local_internal_network}} 0.0.0.255 any
!